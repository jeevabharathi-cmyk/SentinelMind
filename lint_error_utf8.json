[{"filePath":"C:\\Users\\jeeva bharathi\\OneDrive\\Desktop\\SentinelMind\\src\\context\\SecurityContext.jsx","messages":[{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\n  11 |     const [mfaVerified, setMfaVerified] = useState(false);\n  12 |     const [auditLogs, setAuditLogs] = useState([]);\n> 13 |     const [lastActivity, setLastActivity] = useState(Date.now());\n     |                                                      ^^^^^^^^^^ Cannot call impure function\n  14 |\n  15 |     const logAction = useCallback((action, target = 'System') => {\n  16 |         const newLog = {","line":13,"column":54,"nodeType":null,"endLine":13,"endColumn":64}],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":89,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":89,"endColumn":25,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useState, useEffect, useCallback } from 'react';\r\n\r\nconst SecurityContext = createContext(null);\r\n\r\n// Session Timeout (15 minutes for production security)\r\nconst SESSION_TIMEOUT = 15 * 60 * 1000;\r\n\r\nexport const SecurityProvider = ({ children }) => {\r\n    const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n    const [user, setUser] = useState(null);\r\n    const [mfaVerified, setMfaVerified] = useState(false);\r\n    const [auditLogs, setAuditLogs] = useState([]);\r\n    const [lastActivity, setLastActivity] = useState(Date.now());\r\n\r\n    const logAction = useCallback((action, target = 'System') => {\r\n        const newLog = {\r\n            id: `AUD-${Math.floor(Math.random() * 10000)}`,\r\n            action,\r\n            actor: user?.name || 'Anonymous',\r\n            target,\r\n            timestamp: new Date().toISOString(),\r\n            hash: btoa(Math.random().toString()).substring(0, 8),\r\n            status: 'Verified'\r\n        };\r\n        setAuditLogs(prev => [newLog, ...prev].slice(0, 100));\r\n        console.log(`[Audit Log]: ${action} by ${newLog.actor}`);\r\n    }, [user]);\r\n\r\n    const login = () => {\r\n        // Simulate secure login\r\n        setUser({ name: 'SOC Analyst 01', role: 'SOC Analyst', email: 'analyst@sentinelmind.ai' });\r\n        setIsAuthenticated(true);\r\n        logAction('Login Attempt - Credentials Verified');\r\n    };\r\n\r\n    const verifyMfa = (code) => {\r\n        if (code.join('').length === 6) {\r\n            setMfaVerified(true);\r\n            logAction('MFA Verification Successful');\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n\r\n    const logout = useCallback(() => {\r\n        setIsAuthenticated(false);\r\n        setUser(null);\r\n        setMfaVerified(false);\r\n        logAction('User Logout');\r\n    }, [logAction]);\r\n\r\n    // Activity Monitor\r\n    useEffect(() => {\r\n        const handleActivity = () => setLastActivity(Date.now());\r\n        window.addEventListener('mousemove', handleActivity);\r\n        window.addEventListener('keydown', handleActivity);\r\n\r\n        const checkTimeout = setInterval(() => {\r\n            if (isAuthenticated && Date.now() - lastActivity > SESSION_TIMEOUT) {\r\n                logout();\r\n                alert('Session expired due to inactivity for security reasons.');\r\n            }\r\n        }, 60000);\r\n\r\n        return () => {\r\n            window.removeEventListener('mousemove', handleActivity);\r\n            window.removeEventListener('keydown', handleActivity);\r\n            clearInterval(checkTimeout);\r\n        };\r\n    }, [isAuthenticated, lastActivity, logout]);\r\n\r\n    return (\r\n        <SecurityContext.Provider value={{\r\n            isAuthenticated,\r\n            user,\r\n            mfaVerified,\r\n            auditLogs,\r\n            login,\r\n            verifyMfa,\r\n            logout,\r\n            logAction\r\n        }}>\r\n            {children}\r\n        </SecurityContext.Provider>\r\n    );\r\n};\r\n\r\n// eslint-disable-next-line react-refresh/only-export-components\r\nexport const useSecurity = () => useContext(SecurityContext);\r\n","usedDeprecatedRules":[]}]
